<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Ù…Ø·Ø¨Ø® Ø§Ù„Ø£ØµØ§Ù„Ø© | Ù…Ø£ÙƒÙˆÙ„Ø§Øª Ø´Ù‡ÙŠØ©</title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Changa:wght@400;700&family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root { --primary: #e67e22; --dark: #2c3e50; --success: #27ae60; --bg: #fdfbf9; }

        /* Ù…Ù†Ø¹ Ø§Ù„Ø²ÙˆÙˆÙ… Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ */
        * { touch-action: manipulation; }
        body { background-color: var(--bg); font-family: 'Cairo', sans-serif; -webkit-text-size-adjust: 100%; overflow-x: hidden; }
        input, textarea, select, .form-control { font-size: 16px !important; border-radius: 12px !important; }

        /* Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø¨ØµØ±ÙŠØ© */
        .navbar { background: var(--dark); border-bottom: 4px solid var(--primary); padding: 12px 0; }
        .navbar-brand { font-family: 'Changa', sans-serif; font-weight: 700; font-size: 1.6rem; color: #fff !important; }
        .hero-banner { background: linear-gradient(135deg, var(--primary), #d35400); color: #fff; padding: 15px; text-align: center; font-family: 'Changa', sans-serif; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }

        /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª */
        .food-card { border: none; border-radius: 20px; background: #fff; box-shadow: 0 6px 15px rgba(0,0,0,0.05); height: 100%; transition: 0.3s; }
        .card-img-top { height: 140px; object-fit: cover; border-radius: 20px 20px 0 0; }
        .price-tag { color: var(--primary); font-size: 1.2rem; font-weight: 800; }
        .btn-add { background: var(--primary); color: #fff; border: none; border-radius: 10px; padding: 8px; width: 100%; font-weight: 700; }

        /* Ø§Ù„Ø³Ù„Ø© Ø§Ù„Ø¹Ø§Ø¦Ù…Ø© */
        .cart-float { position: fixed; bottom: 20px; left: 20px; width: 60px; height: 60px; background: var(--success); color: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; z-index: 1000; box-shadow: 0 8px 20px rgba(0,0,0,0.2); border: none; }

        /* Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ */
        .modal-content { border-radius: 25px; border: none; }
        .modal-header { background: var(--dark); color: #fff; border-radius: 25px 25px 0 0; }
        .delete-item { color: #e74c3c; cursor: pointer; }
    </style>
</head>
<body>

    <nav class="navbar navbar-dark shadow-sm">
        <div class="container text-center"><span class="navbar-brand">Ù…Ø·Ø¨Ø® Ø§Ù„Ø£ØµØ§Ù„Ø© <i class="fas fa-utensils ms-2"></i></span></div>
    </nav>

    <div class="hero-banner">âœ¨ Ø·Ø¹Ù… Ø§Ù„Ø´Ø§Ù… Ø§Ù„Ø£ØµÙŠÙ„.. Ø¨ÙŠÙ† ÙŠØ¯ÙŠÙƒ Ø§Ù„Ø¢Ù† âœ¨</div>

    <div class="container mt-4 mb-5">
        <div class="row g-3" id="menu-container"></div>
    </div>

    <button class="cart-float" onclick="openCart()">
        <i class="fas fa-shopping-basket"></i>
        <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" id="cart-badge">0</span>
    </button>

    <div class="modal fade" id="cartModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title fw-bold">ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨Ùƒ ğŸ›’</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="cart-items-list" class="mb-3"></div>
                    <div class="p-3 bg-light rounded-3 d-flex justify-content-between align-items-center">
                        <span class="fw-bold">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹:</span>
                        <span id="total-price" class="fw-bold text-success fs-4">0.00 â‚¬</span>
                    </div>
                </div>
                <div class="modal-footer border-0">
                    <button class="btn btn-warning w-100 py-3 fw-bold rounded-3" onclick="goToCheckout()">Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ <i class="fas fa-arrow-left ms-2"></i></button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="checkoutModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header" style="background: var(--primary);">
                    <h5 class="modal-title fw-bold">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙˆØµÙŠÙ„ ğŸšš</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row g-3">
                        <div class="col-12"><input type="text" id="u-name" class="form-control p-3" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„"></div>
                        <div class="col-12"><input type="tel" id="u-phone" class="form-control p-3" placeholder="Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨"></div>
                        <div class="col-12">
                            <label class="small text-muted mb-1">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…:</label>
                            <input type="date" id="u-date" class="form-control p-3">
                        </div>
                        <div class="col-12"><textarea id="u-notes" class="form-control p-3" rows="2" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©.."></textarea></div>
                    </div>
                </div>
                <div class="modal-footer border-0">
                    <button class="btn btn-success w-100 py-3 fw-bold rounded-3" onclick="finalSend()">Ø§Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ <i class="fab fa-telegram-plane ms-2"></i></button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script>
        // Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ¨ÙŠØ±
        document.addEventListener('touchstart', (e) => { if (e.touches.length > 1) e.preventDefault(); }, { passive: false });

        const CONFIG = { token: "8394320495:AAGyRY5siD2sQBbjL_JaoY1h6GH016TGBYM", chatId: "1117141728" };

        const menu = [
            { id: 1, name: "ÙƒØ¨Ø© Ù…Ù‚Ù„ÙŠØ©", price: 1.50, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/8/88/Kibbeh3.jpg/330px-Kibbeh3.jpg" },
            { id: 2, name: "ÙƒØ¨Ø© Ù…Ø´ÙˆÙŠØ©", price: 2.00, img: "https://upload.wikimedia.org/wikipedia/commons/thumb/6/60/Kobbeh.png/330px-Kobbeh.png" },
            { id: 3, name: "ÙƒØ¨Ø© Ù„Ø¨Ù†ÙŠØ©", price: 1.00, img: "https://upload.wikimedia.org/wikipedia/commons/2/2c/%D9%83%D8%A8%D8%A9_%D9%84%D8%A8%D9%86%D9%8A%D8%A9.jpg" },
            { id: 4, name: "Ø¨Ø±Ùƒ Ø¬Ø¨Ù†Ø©", price: 0.50, img: "https://img-global.cpcdn.com/recipes/12bfcf2ff2cff20f/1280x1280sq80/photo.webp" }
        ];

        let cart = [];
        let lastId = null;

        function renderMenu() {
            let opts = "";
            for (let i = 5; i <= 200; i += 5) opts += `<option value="${i}">${i} Ù‚Ø·Ø¹Ø©</option>`;
            document.getElementById('menu-container').innerHTML = menu.map(i => `
                <div class="col-6 col-md-3">
                    <div class="food-card p-2 text-center">
                        <img src="${i.img}" class="card-img-top">
                        <div class="food-title mt-2">${i.name}</div>
                        <div class="price-tag my-2">${i.price.toFixed(2)} â‚¬</div>
                        <select id="qty-${i.id}" class="form-select form-select-sm mb-2 text-center">${opts}</select>
                        <button class="btn btn-add" onclick="addToCart(${i.id})">Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©</button>
                    </div>
                </div>`).join('');
        }

        function addToCart(id) {
            const p = menu.find(x => x.id === id);
            const q = parseInt(document.getElementById(`qty-${id}`).value);
            const ex = cart.find(c => c.id === id);
            if (ex) ex.qty += q; else cart.push({ ...p, qty: q });
            updateBadge();
            Swal.fire({ toast: true, position: 'top', icon: 'success', title: 'ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©', showConfirmButton: false, timer: 800 });
        }

        function updateBadge() { document.getElementById('cart-badge').innerText = cart.reduce((a, b) => a + b.qty, 0); }

        function openCart() {
            const list = document.getElementById('cart-items-list');
            let total = 0;
            if (cart.length === 0) {
                list.innerHTML = '<p class="text-center py-3">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</p>';
            } else {
                list.innerHTML = cart.map((item, idx) => {
                    total += item.price * item.qty;
                    return `<div class="d-flex justify-content-between align-items-center border-bottom py-2">
                        <div><b>${item.name}</b> (x${item.qty})<br><small class="text-success">${(item.price*item.qty).toFixed(2)}â‚¬</small></div>
                        <i class="fas fa-trash-alt delete-item" onclick="removeItem(${idx})"></i>
                    </div>`;
                }).join('');
            }
            document.getElementById('total-price').innerText = total.toFixed(2) + " â‚¬";
            new bootstrap.Modal(document.getElementById('cartModal')).show();
        }

        function removeItem(i) { cart.splice(i, 1); updateBadge(); openCart(); }

        function goToCheckout() {
            if (cart.length === 0) return Swal.fire("Ø¹Ø°Ø±Ø§Ù‹", "Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©", "warning");
            bootstrap.Modal.getInstance(document.getElementById('cartModal')).hide();
            setTimeout(() => { new bootstrap.Modal(document.getElementById('checkoutModal')).show(); }, 400);
        }

        async function finalSend() {
            const name = document.getElementById('u-name').value;
            const phone = document.getElementById('u-phone').value;
            const date = document.getElementById('u-date').value;
            if (!name || !phone || !date) return Swal.fire("ØªÙ†Ø¨ÙŠÙ‡", "Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", "error");

            let msg = `ğŸ´ *Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ù…Ø·Ø¨Ø® Ø§Ù„Ø£ØµØ§Ù„Ø©*\nğŸ‘¤ *Ø§Ù„Ø²Ø¨ÙˆÙ†:* ${name}\nğŸ“ *Ù‡Ø§ØªÙ:* ${phone}\nğŸ“… *Ø§Ù„Ù…ÙˆØ¹Ø¯:* ${date}\nğŸ“ *Ù…Ù„Ø§Ø­Ø¸Ø§Øª:* ${document.getElementById('u-notes').value || '-'}\n\nğŸ›’ *Ø§Ù„Ø·Ù„Ø¨Ø§Øª:* \n`;
            let total = 0;
            cart.forEach(i => { msg += `â€¢ ${i.name} (x${i.qty}) = ${(i.price*i.qty).toFixed(2)}â‚¬\n`; total += i.price*i.qty; });
            msg += `\nğŸ’° *Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${total.toFixed(2)} â‚¬*`;

            fetch(`https://api.telegram.org/bot${CONFIG.token}/sendMessage`, {
                method: 'POST', headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ chat_id: CONFIG.chatId, text: msg, parse_mode: "Markdown" })
            }).then(() => {
                Swal.fire("ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„!", "ÙˆØµÙ„ Ø·Ù„Ø¨Ùƒ Ù„Ù„Ù…Ø·Ø¨Ø® Ø¨Ù†Ø¬Ø§Ø­", "success");
                cart = []; updateBadge();
                bootstrap.Modal.getInstance(document.getElementById('checkoutModal')).hide();
            });
        }

        async function checkNews() {
            try {
                const r = await fetch(`https://api.telegram.org/bot${CONFIG.token}/getUpdates?offset=-1`);
                const d = await r.json();
                if (d.ok && d.result.length > 0) {
                    const m = d.result[0].message;
                    if (lastId !== null && m.message_id !== lastId) {
                        Swal.fire({ title: 'Ø±Ø³Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ù…Ø·Ø¨Ø® ğŸ“¢', text: m.text, icon: 'info' });
                    }
                    lastId = m.message_id;
                }
            } catch(e) {}
        }
        setInterval(checkNews, 10000);

        window.onload = () => { renderMenu(); checkNews(); };
    </script>
</body>
</html>
